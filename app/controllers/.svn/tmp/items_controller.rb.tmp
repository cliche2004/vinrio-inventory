class ItemsController < ApplicationController
  def index
  	_init
    render :partial => 'index'
  end

  def ajax_list
  	_init
  	render :update do |page|
			page.replace_html 'list', :partial => 'list' 
			page << "$('message_area').hide();"
	end
  end
  
  def ajax_new
  	_init
  	render :update do |page|
		page.replace_html 'list', :partial => 'new' 
	end
  end

  def ajax_edit
   	@item = Item.find(params[:id])
  	_init
  	render :update do |page|
		if @item
			page.replace_html 'list', :partial => 'edit' 
	    end
	end
  end 
  
  def ajax_create
  	@item = Item.new(params[:item])
  	  	
	render :update do |page|
		if @item.save
			@items = Item.find(:all)
			page.replace_html 'list', :partial => 'list' 			
		else
			page.replace_html 'message_area', error_messages_for(:item)
		end
	end
   end 
   
  def ajax_update
  	@item = Item.find(params[:id])
  	
	render :update do |page|
		if @item.update_attributes(params[:item])
			@items = Item.find(:all)
			flash[:notice] = "Updated Successfuly."
			page.replace_html 'list', :partial => 'list'
		else
          page.replace_html 'message_area', error_messages_for(:item)
    end
	
	end
  end
  
  def ajax_delete
  	@item = Item.find(params[:id])
    
    render :update do |page|
	  	if @item.destroy
	  		@items = Item.find(:all)
	  		page.replace_html 'list', :partial => 'list'
	  	end
	end
  end
  
  def _init
  	@type = ItemType.find(:all)
  	@units = Measurement.find(:all)
  	@items = Item.find(:all)
  end
end
