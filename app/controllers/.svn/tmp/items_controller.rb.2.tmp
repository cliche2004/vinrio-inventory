class ItemsController < ApplicationController
  def index
  	@items = Item.find(:all)
    render :partial => 'index'
  end

  def ajax_list
  	@items = Item.find(:all)
  	render :update do |page|
<<<<<<< .mine
			page.replace_html 'list', :partial => 'list' 
	  end
=======
			page.replace_html 'list', :partial => 'list' 			
	end
>>>>>>> .r108
  end
  
  def ajax_new
  	@item = Item.new
  	_init
  	render :update do |page|
		  page.replace_html 'list', :partial => 'new' 
	  end
  end

  def ajax_edit
   	@item = Item.find(params[:id])
  	_init
  	
  	render :update do |page|
		  if @item
			  page.replace_html 'list', :partial => 'edit' 
	    end
	  end
  end 
  
  def ajax_create
  	@item = Item.new(params[:item])
  	  	
	  render :update do |page|
		  if @item.save
			  @items = Item.find(:all)
			  page.replace_html 'list', :partial => 'list' 			
		  else
			  page.replace_html 'message_area', error_messages_for(:item)
			  page << "jQuery('#message_area').slideDown()"
		  end
	  end
  end 
   
  def ajax_update
  	@item = Item.find(params[:id])
  	
	  render :update do |page|
		  if @item.update_attributes(params[:item])
			  @items = Item.find(:all)
			  page.replace_html 'list', :partial => 'list'
		  else
          page.replace_html 'message_area', error_messages_for(:item)
          page << "jQuery('#message_area').slideDown()"
        end
	    end
  end
  
  def ajax_delete
  	@item = Item.find(params[:id])
    
    render :update do |page|
	  	if @item.destroy
	  		@items = Item.find(:all)
	  		page.replace_html 'list', :partial => 'list'
	  	end
	  end
  end
  
  def _init
  	@types = ItemType.find(:all)
  	@units = Measurement.find(:all)
  	@storage_locations = StorageLocation.find(:all)
  end
end
